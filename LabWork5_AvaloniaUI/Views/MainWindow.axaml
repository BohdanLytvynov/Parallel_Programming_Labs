<Window xmlns="https://github.com/avaloniaui"
		xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
		xmlns:vm="using:LabWork5_AvaloniaUI.ViewModels"
		xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
		xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
		mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="450"
		x:Class="LabWork5_AvaloniaUI.Views.MainWindow"
		x:DataType="vm:MainWindowViewModel"
		Icon="/Assets/avalonia-logo.ico"
		Title="{Binding Title}"
		xmlns:conv="clr-namespace:LabWork5_AvaloniaUI.Converters"
		xmlns:i="clr-namespace:Avalonia.Xaml.Interactivity;assembly=Avalonia.Xaml.Interactivity"
		xmlns:behaviors="clr-namespace:LabWork5_AvaloniaUI.Behaviors">

	<Window.Resources>
		<ResourceDictionary>
			<ResourceDictionary.MergedDictionaries>
				<ResourceInclude Source="avares://LabWork5_AvaloniaUI/Templates/MatrixOperationTemplate.axaml"/>
			</ResourceDictionary.MergedDictionaries>

			<conv:StringToIntConverter x:Key="StrToInt"/>
		</ResourceDictionary>
	</Window.Resources>

	<Design.DataContext>
		<!-- This only sets the DataContext for the previewer in an IDE,
		to set the actual DataContext for runtime, set the DataContext property in code (look at App.axaml.cs) -->
		<vm:MainWindowViewModel/>
	</Design.DataContext>

	<Grid IsEnabled="{Binding MainIsEnabled, UpdateSourceTrigger=PropertyChanged}" 
		  RowDefinitions="45,*,45" ShowGridLines="{Binding ShowGridLines}">
		<Label Classes="Title" Grid.Row="0" HorizontalAlignment="Center">Matrix Calculator</Label>
		<Border Grid.Row="1" Classes="MainBorder" Margin="10">
			<Grid ColumnDefinitions="*,Auto,*">
				<Grid RowDefinitions="35,35,*"
					  Grid.Column="0"
					  ShowGridLines="{Binding ShowGridLines}">
					<StackPanel Grid.Row="0"
								VerticalAlignment="Center"
								Orientation="Horizontal">
						<Label Content="Rows:"/>
						<TextBox Text="{Binding RowsA,
						UpdateSourceTrigger=PropertyChanged, Converter={StaticResource StrToInt}}"/>
						<Button Content="Generate"
								Margin="40,0,0,0"
								Command="{Binding GenerateMatCommand}"
								CommandParameter="A"
								/>
					</StackPanel>
					<StackPanel Grid.Row="1"
								VerticalAlignment="Center"
								Orientation="Horizontal">
						<Label>Columns:</Label>
						<TextBox Text="{Binding ColsA,
						UpdateSourceTrigger=PropertyChanged, Converter={StaticResource StrToInt}}"/>
						<Button Margin="17,0,0,0" Content="Clear"
								Command="{Binding ClearCommand}"
								CommandParameter="A"/>
					</StackPanel>
					<Grid Grid.Row="2" ColumnDefinitions="*,100">
						<Border Classes="MainBorder"
								Margin="10">
							<ScrollViewer VerticalScrollBarVisibility="Visible"
										  HorizontalScrollBarVisibility="Visible">
								<DataGrid Margin="20"
										  AutoGenerateColumns="False"
										  IsReadOnly="True"
										  GridLinesVisibility="All"
										  BorderThickness="1" BorderBrush="Gray"
										  ItemsSource="{Binding MatAPresenter}">
									<i:Interaction.Behaviors>
										<behaviors:DataGridColumnsBehavior ColumnCount="{Binding ColsA}" />
									</i:Interaction.Behaviors>
								</DataGrid>
							</ScrollViewer>
						</Border>
						<StackPanel Orientation="Vertical" Grid.Column="1"
									VerticalAlignment="Center">
							<Label>Operation:</Label>
							<ComboBox ItemsSource="{Binding Operations}"
									  SelectedIndex="{Binding SelectedOperationIndex}"
									  ItemTemplate="{StaticResource MatrixOperTemplate}"
									  IsEnabled="{Binding CanOperationSelected, UpdateSourceTrigger=PropertyChanged}"/>
						</StackPanel>
					</Grid>
				</Grid>
				<GridSplitter Grid.Column="1" Classes="Vertical"/>
				<Grid Grid.Column="2"
					  RowDefinitions="35,35,*">
					<StackPanel Grid.Row="0"
								Orientation="Horizontal"
								VerticalAlignment="Center">
						<Label>Rows:</Label>
						<TextBox Text="{Binding RowsB,
						UpdateSourceTrigger=PropertyChanged,
						Converter={StaticResource StrToInt}}"/>
						<Button Content="Generate"
								Margin="40,0,0,0"
								Command="{Binding GenerateMatCommand}"
								CommandParameter="B"
								/>
					</StackPanel>
					<StackPanel Grid.Row="1"
								Orientation="Horizontal"
								VerticalAlignment="Center">
						<Label>Columns:</Label>
						<TextBox Text="{Binding ColsB,
						UpdateSourceTrigger=PropertyChanged,
						Converter={StaticResource StrToInt}}"/>

						<Button Margin="17,0,0,0" Content="Clear"
								Command="{Binding ClearCommand}"
								CommandParameter="B"/>
					</StackPanel>
					<Border Classes="MainBorder" Grid.Row="2"
							Margin="10">
						<ScrollViewer VerticalScrollBarVisibility="Visible"
									  HorizontalScrollBarVisibility="Visible">
							<DataGrid Margin="20"
									  AutoGenerateColumns="False"
									  IsReadOnly="True"
									  GridLinesVisibility="All"
									  BorderThickness="1" BorderBrush="Gray"
									  ItemsSource="{Binding MatBPresenter}">
								<i:Interaction.Behaviors>
									<behaviors:DataGridColumnsBehavior ColumnCount="{Binding ColsB}" />
								</i:Interaction.Behaviors>
							</DataGrid>
						</ScrollViewer>
					</Border>
				</Grid>
			</Grid>
		</Border>
		<Grid Name="ButtonsGrid" ShowGridLines="{Binding ShowGridLines}"
			  ColumnDefinitions="*,100,10,50,20" Grid.Row="2">
			<Button Grid.Column="1" Command="{Binding CalculateCommand}">Calculate</Button>
			<Button Grid.Column="3" Command="{Binding ExitCommand}">Exit</Button>
		</Grid>
	</Grid>

</Window>
